{"prompt": "List the games Virat Kohli has scored over 65 runs.", "completion": "SELECT matches.match_id, matches.match_date, matches.format, matches.venue_id, \n       CASE\n           WHEN matches.team1_id = batting.team_id THEN team2.team_name\n           ELSE team1.team_name\n       END AS opponent_team,\n       batting.runs\nFROM matches\nINNER JOIN teams AS team1 ON matches.team1_id = team1.team_id\nINNER JOIN teams AS team2 ON matches.team2_id = team2.team_id\nINNER JOIN batting ON matches.match_id = batting.match_id AND batting.player_name = 'Virat Kohli'\nWHERE matches.match_date <= NOW() AND batting.runs > 65\nORDER BY matches.match_date DESC;\n"}
{"prompt": "Who are the top 5 batsmen with the highest strike rate in T20Is?", "completion": "SELECT players.player_name, \n       SUM(batting.runs) AS total_runs, \n       SUM(batting.balls) AS total_balls, \n       ROUND((SUM(batting.runs) / SUM(batting.balls) * 100), 2) AS strike_rate\nFROM batting\nJOIN players ON batting.player_id = players.player_id\nJOIN matches ON batting.match_id = matches.match_id\nWHERE matches.format = 'T20I'\nGROUP BY batting.player_id, players.player_name\nHAVING total_balls > 50 -- Minimum 50 balls faced to qualify\nORDER BY strike_rate DESC\nLIMIT 5;\n"}
{"prompt": "Which games has Ben Stokes been man of the match?", "completion": "SELECT m.match_id, m.match_date, m.match_winner_name, m.player_of_the_match\nFROM matches m\nWHERE m.player_of_the_match = 'Ben Stokes';\n"}
{"prompt": "What was Kohli's ODI batting average in 2019?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(bat.runs) AS total_runs,\n       COUNT(CASE WHEN bat.description NOT LIKE '%not out%' AND bat.description NOT LIKE '%retired hurt%' THEN 1 END) AS total_dismissals,\n       ROUND(SUM(bat.runs) / COUNT(CASE WHEN bat.description NOT LIKE '%not out%' AND bat.description NOT LIKE '%retired hurt%' THEN 1 END), 2) AS batting_average\nFROM batting bat\nJOIN players p ON bat.player_id = p.player_id\nJOIN matches m ON bat.match_id = m.match_id\nWHERE p.player_name LIKE '%Kohli%' AND m.format = 'ODI' AND YEAR(m.match_date) = 2019\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "What is Shami's career white ball bowling average?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(bowl.runs) AS total_runs_conceded,\n       SUM(bowl.wickets) AS total_wickets,\n       SUM(bowl.runs) / SUM(bowl.wickets) AS bowling_average\nFROM bowling bowl\nJOIN players p ON bowl.player_id = p.player_id\nJOIN matches m ON bowl.match_id = m.match_id\nWHERE p.player_name LIKE '%Shami%' AND m.format IN ('ODI', 'T20I')\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "List the bowlers with the best bowling average in Test cricket.", "completion": "SELECT p.player_id, p.player_name,\n       SUM(bowl.runs) AS total_runs_conceded,\n       SUM(bowl.wickets) AS total_wickets,\n       SUM(bowl.runs) / SUM(bowl.wickets) AS bowling_average\nFROM bowling bowl\nJOIN players p ON bowl.player_id = p.player_id\nJOIN matches m ON bowl.match_id = m.match_id\nWHERE m.format = 'Test' AND bowl.wickets > 0\nGROUP BY p.player_id, p.player_name\nORDER BY bowling_average ASC;\n"}
{"prompt": "What is Ravichandran Ashwin's bowling strike rate in test cricket?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(FLOOR(bowl.overs) * 6 + ((bowl.overs - FLOOR(bowl.overs)) * 10)) AS total_balls_bowled,\n       SUM(bowl.wickets) AS total_wickets,\n       ROUND(SUM(FLOOR(bowl.overs) * 6 + ((bowl.overs - FLOOR(bowl.overs)) * 10)) / SUM(bowl.wickets), 2) AS bowling_strike_rate\nFROM bowling bowl\nJOIN players p ON bowl.player_id = p.player_id\nJOIN matches m ON bowl.match_id = m.match_id\nWHERE p.player_name = 'Ravichandran Ashwin' AND m.format = 'Test' AND bowl.wickets > 0\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "What is Rohit Sharma's career ODI boundary percentage?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(batting.fours + batting.sixes) AS total_boundaries,\n       SUM(batting.balls) AS total_balls_faced,\n       ROUND((SUM(batting.fours + batting.sixes) / SUM(batting.balls) * 100), 2) AS boundary_percentage\nFROM batting\nJOIN players p ON batting.player_id = p.player_id\nJOIN matches m ON batting.match_id = m.match_id\nWHERE p.player_name = 'Rohit Sharma' AND m.format = 'ODI'\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "What is Rohit Sharma's average while opening in ODIs?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(bat.runs) AS total_runs,\n       COUNT(CASE WHEN bat.batting_position IN (1, 2) THEN 1 END) AS total_matches_as_opener,\n       COUNT(CASE WHEN bat.batting_position IN (1, 2) AND bat.description NOT LIKE '%not out%' AND bat.description NOT LIKE '%retired hurt%' THEN 1 END) AS total_dismissals,\n       SUM(bat.runs) / COUNT(CASE WHEN bat.batting_position IN (1, 2) AND bat.description NOT LIKE '%not out%' AND bat.description NOT LIKE '%retired hurt%' THEN 1 END) AS batting_average_as_opener\nFROM batting bat\nJOIN players p ON bat.player_id = p.player_id\nJOIN matches m ON bat.match_id = m.match_id\nWHERE p.player_name LIKE '%Rohit Sharma%' AND m.format = 'ODI' AND bat.batting_position IN (1, 2)\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "What is Stokes's average while batting at no.5 in ODIs?", "completion": "SELECT p.player_id, p.player_name,\n       SUM(bat.runs) AS total_runs,\n       COUNT(CASE WHEN bat.batting_position = 5 THEN 1 END) AS total_matches_at_no_5,\n       COUNT(CASE WHEN bat.batting_position = 5 AND bat.description NOT LIKE '%not out%' THEN 1 END) AS total_dismissals_at_no_5,\n       SUM(bat.runs) / COUNT(CASE WHEN bat.batting_position = 5 AND bat.description NOT LIKE '%not out%' THEN 1 END) AS batting_average_at_no_5\nFROM batting bat\nJOIN players p ON bat.player_id = p.player_id\nJOIN matches m ON bat.match_id = m.match_id\nWHERE p.player_name LIKE '%Stokes%' AND m.format = 'ODI' AND bat.batting_position = 5\nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "How many ducks has Kohli gotten in his career?", "completion": "SELECT p.player_id, p.player_name,\n       COUNT(CASE WHEN bat.runs = 0 AND bat.description NOT LIKE '%not out%' THEN 1 END) AS total_ducks\nFROM batting bat\nJOIN players p ON bat.player_id = p.player_id\nWHERE p.player_name LIKE '%Kohli%' \nGROUP BY p.player_id, p.player_name;\n"}
{"prompt": "List the 100s in ODI cricket with the highest strike rate.", "completion": "SELECT p.player_id, p.player_name,\n       bat.runs AS century_runs,\n       bat.balls AS balls_faced,\n       ROUND((bat.runs / bat.balls * 100), 2) AS strike_rate\nFROM batting bat\nJOIN players p ON bat.player_id = p.player_id\nJOIN matches m ON bat.match_id = m.match_id\nWHERE bat.runs >= 100 AND m.format = 'ODI'\nORDER BY (bat.runs / bat.balls * 100) DESC;\n"}